#!/usr/bin/env bash

icon="$HOME/.lock.png"
tmpbg='/tmp/screen.png'

_lock(){
i3lock -n -e -i "$tmpbg" -u
}

scrot "$tmpbg"
convert "$tmpbg"  -channel RGBA  -blur 0x8  "$tmpbg"
convert "$tmpbg" "$icon" -gravity center -composite -matte "$tmpbg"

if [[ $1 = "suspend" ]]; then
 systemctl suspend && _lock 
elif [[ $1 = "hibernate" ]]; then
  systemctl hibernate
else 
  _lock
fi
